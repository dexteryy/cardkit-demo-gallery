<!DOCTYPE html>
<html>
<head>
@@include("common/header.html", { 
    "title": "@@appname" 
})
</head>
<body>

@@include("common/actions.html")

<div class="my-app">

@@include("pagecard/navdrawer.html")

<ck-card type="page" id="ckDefault">

    @@include("common/page_parts.html", { 
        "title": "Overlay"
    })

    <ck-card type="list" subtype="menu">
        <ck-part type="hd">Source code</ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/CardKit/blob/master/cardkit/ui/modalview.js" target="_blank">cardkit/ui/modalview</ck-part>
            <ck-part type="desc">`require('cardkit').modalCard`</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/dexteryy/moui/blob/master/modalview.js" target="_blank">moui/modalview</ck-part>
            <ck-part type="desc">The original class</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/CardKit/blob/master/cardkit/ui/actionview.js" target="_blank">cardkit/ui/actionview</ck-part>
            <ck-part type="desc">`require('cardkit').actionView`</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/dexteryy/moui/blob/master/actionview.js" target="_blank">moui/actionview</ck-part>
            <ck-part type="desc">The original class</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/CardKit/blob/master/cardkit/ui/growl.js" target="_blank">cardkit/ui/growl</ck-part>
            <ck-part type="desc">`require('cardkit').growl`</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/dexteryy/moui/blob/master/growl.js" target="_blank">moui/growl</ck-part>
            <ck-part type="desc">The original class</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/CardKit/blob/master/scss/cardkit/active/_overlay.scss" target="_blank">scss/cardkit/active/_overlay.scss</ck-part>
            <ck-part type="desc">Skin for overlays</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/CardKit/blob/master/cardkit/ui.js" target="_blank">cardkit/ui</ck-part>
            <ck-part type="desc">Higher-lever interface</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/CardKit/blob/master/scss/cardkit/active/_popup.scss" target="_blank">scss/cardkit/active/_popup.scss</ck-part>
            <ck-part type="desc">Skin for buttons</ck-part>
        </ck-part>
        <ck-part type="item">
            <ck-part type="title" href="https://github.com/douban-f2e/cardkit-demo-gallery/blob/master/docs/overlay.html" target="_blank">cardkit-demo-gallery/docs/overlay.html</ck-part>
            <ck-part type="desc">The current page</ck-part>
        </ck-part>
    </ck-card>

    <ck-card type="box" paper-style="true">
        <ck-part type="hd"><span id="usages">Usages</span></ck-part>
    </ck-card>

    <ck-card type="box" plain-style="true">
        <ck-part type="hd">Modal View</ck-part>
    </ck-card>

    <ck-card type="form">
        <ck-part type="hd">Examples</ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-modal-button demo" 
data-url="api/formcontent.html" 
data-title="ajax">Open</button>
<!--demo end-->
            <label>用ajax接口加载内容</label>
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-modal-button demo" 
data-json-url="api/form_json.html" 
data-title="json">Open</button>
<!--demo end-->
            <label>用json接口加载内容</label>
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-modal-button demo" 
data-iframe-url="formpage.html" disabled
data-title="iframe">Open</button>
<!--demo end-->
            <label>用iframe加载内容<br>（暂不支持）</label>
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-modal-button demo" 
data-source="formBox" 
data-title="inline html">Open</button>
<!--demo end-->
            <label>用隐藏的html作内容</label>
            @@include("common/show_html.html")
        </ck-part>
    </ck-card>

    <ck-card type="box" plain-style="true">
        <ck-part type="hd">Action View</ck-part>
    </ck-card>

    <ck-card type="form">
        <ck-part type="hd">Examples</ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-select demo"
    data-fluid="true"
    data-title="Choose the page">
<span>Choose the page</span>
<a href="picker.html" class="ck-option">picker.html</a>
<a href="control.html" class="ck-option">control.html</a>
<a href="index.html" class="ck-option">index.html</a>
</button>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<div class="ck-select demo" id="actions1"
    data-fluid="true"
    data-title="Choose the order">
<input type="hidden" value="date">
<button type="button" value="price" 
     data-a="1" data-b="10" class="ck-option">Order by price</button>
<button type="button" value="date" 
     data-a="2" data-b="20"  class="ck-option enabled">Order by date</button>
<button type="button" value="alpha" 
     data-a="3" data-b="30"  class="ck-option">Order by alphabet</button>
<button type="button" value="editor" 
     data-a="4" data-b="40"  class="ck-option">Order by editor</button>
</div>
<!--demo end-->
            @@include("common/show_html.html")
            @@include("common/show_js.html", {
                "source": "#jsForSelect" 
            })
        </ck-part>
        <ck-part type="item">
<!--demo-->
<div class="ck-select demo" id="actions2"
    data-fluid="true"
    data-multiselect="true"
    data-title="Choose members"
    data-content="1. member A<br>2. member B<br>3. member C<br>4. member D">
<span>Choose members</span>
<input type="hidden" value="date">
<button class="ck-option" type="button" value="A" data-a="1" data-b="10">A</button>
<button class="ck-option enabled" type="button" value="B" data-a="2" data-b="20">B</button>
<button class="ck-option" type="button" value="C" data-a="3" data-b="30">C</button>
<button class="ck-option" type="button" value="D" data-a="4" data-b="40">D</button>
</div>
<!--demo end-->
            @@include("common/show_html.html")
            @@include("common/show_js.html", {
                "source": "#jsForSelect" 
            })
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-actions-button actions3 demo"
    data-fluid="true"
    data-multiselect="true"
    data-confirm-text="继续"
    data-cancel-text="放弃"
    data-title="Choose members"
    data-content="1. member A<br>2. member B<br>3. member C<br>4. member D">
<span>Choose members</span>
<input class="ck-option" type="button" value="A" data-a="1" data-b="10">
<input class="ck-option enabled" type="button" value="B" data-a="2" data-b="20">
<input class="ck-option" type="button" value="C" data-a="3" data-b="30">
<input class="ck-option" type="button" value="D" data-a="4" data-b="40">
</button>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-actions-button actions4 demo"
    data-fluid="true">
<span>Jump list</span>
<a href="picker.html" class="ck-option">picker.html</a>
<a href="control.html" class="ck-option">control.html</a>
<a href="index.html" class="ck-option">index.html</a>
<a href="tel:114" class="ck-option">tel:114</a>
</button>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="my-actions-button ckbase-btn"
    data-fluid="true">
<span>Generated Action menu</span>
</button>
<script type="text/darkscript">
var $ = require('dollar');
var ck = require('cardkit');
$(this).on('darkdom:rendered', init_events);
init_events();
function init_events(){
    var notify = ck.growl({
        corner: 'bottom'
    });
    $('.my-actions-button').bind('actionView:confirm', function(e){
        var result = e.component.val();
        console.info('value: ', result);
        notify.set({
            content: 'value: ' + result
        }).open();
    });
    $('.my-actions-button').bind('tap', function(){
        ck.actionView(this, {
            title: 'This is title',
            content: 'This is content<br>This is content<br>This is content<br>This is content<br>This is content<br>',
            options: [
                '<a href="index.html" class="ck-option">index.html</a>',
                '<a href="control.html" class="ck-option">control.html</a>',
                '<a href="picker.html" class="ck-option">picker.html</a>',
                '<a href="overlay.html" class="ck-option">overlay.html</a>',
                '<a href="box.html" class="ck-option">box.html</a>',
                '<a href="mini.html" class="ck-option">mini.html</a>',
                '<a href="list.html" class="ck-option">list.html</a>',
                '<a href="unit.html" class="ck-option">unit.html</a>',
                '<a href="browsers.html" class="ck-option">browsers.html</a>',
                '<a href="tel:114" class="ck-option">tel:114</a>',
                '<a href="#C" class="ck-option">C</a>',
                '<input class="ck-option" type="button" value="A">',
                '<input class="ck-option" type="button" value="B">'
            ].join('')
        }).open();
    });
}
</script>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="my-confirm-button ckbase-btn"
    data-fluid="true">
<span>Confirm/Alert (No Options)</span>
</button>
<script type="text/darkscript" id="jsDemoMyConfirm">
var $ = require('dollar');
var ck = require('cardkit');
$(this).on('darkdom:rendered', init_events);
init_events();
function init_events(){
    $('.my-confirm-button, .my-confirm-button span').on('tap', function(){
        var me = $(this);
        if (!me.hasClass('my-confirm-button')) {
            me = me.parent();
        }
        ck.actionView(me, {
            title: 'This is the title',
            content: 'This is the content',
            multiselect: true
        }).open();
    });
    $('.my-confirm-button').on('actionView:confirm', function(){
        ck.actionView(this).event.once('close', function(){
            var o = ck.confirm('This is the content', function(){
                o.event.once('close', function(){
                    ck.alert('This is the content', {
                        title: 'This is the title',
                        cancelText: 'I see...'
                    });
                });
            }, { 
                title: 'This is the title'
            });
        });
    });
}
</script>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<a class="ck-confirm-link demo" 
    href="index.html" 
    target="_blank"
    data-title="确认要跳转吗？">
Confirm link
</a>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
    </ck-card>

    <ck-card type="box" plain-style="true">
        <ck-part type="hd">Growl</ck-part>
    </ck-card>

    <ck-card type="form">
        <ck-part type="hd">Examples</ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-growl-button demo"
data-corner="center"
data-content="测试！">Tips A</button>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
        <ck-part type="item">
<!--demo-->
<button type="button" class="ck-growl-button demo"
data-expires="1000"
data-content="测试！">Tips B</button>
<!--demo end-->
            @@include("common/show_html.html")
        </ck-part>
    </ck-card>

    @@include("common/default_page_footer.html")

</ck-card>

@@include("common/common_pages.html")

</div>

<div class="my-raw">

<div class="ckdActionbar">
    <button type="button" class="ckd-overflow-item ck-modal-button ckdActionbarItem1" data-url="api/formcontent.html" data-title="动作1">动作1</button>
    <button type="button" class="ckd-item ck-modal-button" data-url="api/formcontent.html" data-title="动作2">动作2</button>
</div>

<script type="text/modalview-html" class="formBox">
<form action="api/post_result_json.html" class="inlineForm1">
<ck-card type="form">
    <ck-part type="item">
        <ck-part type="title">章节名</ck-part>
        <input type="text" value="" name="a" id="inlineForm1_a" placeholder="章节名">
    </ck-part>
    <ck-part type="item">
        <ck-part type="title">笔记内容</ck-part>
        <textarea name="b" id="inlineForm1_b" placeholder="笔记内容"></textarea>
        <label><em>注释</em></label>
    </ck-part>
</ck-card>
</form>
</script>

<script type="text/modalview-javascript" class="formBox">
console.info('execute js for formBox');
var $ = require('dollar');
var net = require('mo/network');
var ck = require('cardkit');
var form = $('.inlineForm1', this);
ck.modalCard.event.bind('confirmOnThis', function(modal){
    modal.showLoading();
    net.ajax({
        url: form.attr('action'),
        type: 'post',
        data: new FormData(form[0]),
        processData: false,
        contentType: false,
        success: function(maybe_json){
            modal.hideLoading();
            var json = net.parseJSON(maybe_json) || { e: 0 };
            if (!json.e) {
                modal.ok();
                /**
                 * other usecase:
                 */
                //-------------
                //location.href = 'api/redirect.html';
                //-------------
                //location.href = 'picker.html';
                //-------------
                //location.reload();
                //-------------
                //modal.ok().then(function(){
                    //location.reload();
                //});
                //-------------
            } else {
                ck.growl({
                    expires: 3000,
                    content: '提交出错！',
                    corner: 'bottom'
                }).open();
            }
        }
    });
});
</script>

</div>

@@include("common/footer.html")

<script id="jsForSelect">
require([
    'dollar',
    'cardkit'
], function($, ck){

    var notify = ck.growl({
        corner: 'bottom'
    });

    ck.brightDelegate.on('actionView:confirm', {
        '#actions1': when_confirm,
        '#actions2': when_confirm
    });

    function when_confirm(e){
        var result = e.component.val();
        var data = e.component.data();
        console.info('value: ', result);
        console.info('data: ', data);
        notify.set({
            content: 'value: ' + result
        }).open();
    }

});
</script>
</body>
</html>

